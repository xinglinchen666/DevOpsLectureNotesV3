# Dev process

## Clone the repo
```
git clone <repo>
```

## Install dependencies

Python:
```
pip install -r requirements.txt
```

Node:
```
npm install
```

Java:
```
mvn install
```

What other language can you think of?

## Before coding

### Plan the journey

Create a Jira Epic to define the scope of the work that you wanna accomplish.

Try to break down the epic as much as possible, step by step for the work.

Create task tickets to track each step.
The steps can be a feature development,
add a unit test for certain APIs or even investigate the tech stack can be a ticket.
The point here is be as specific as possible.

Typically for a feature development, it should take no more 8 hours/story points;
In most cases, it should be controlled with in 3 hours.
https://www.atlassian.com/agile/project-management/estimation

So, before you start coding, you should already have all the plans/tasks created on your Jira software board.

### Branch off the development branch

Let us suppose that you picked a task to add a feature.

Let us also assume that you have `master`/ `staging`/ `prod` branch for this repo.

Now, we need to branch off the feature branch from the master branch, you can either do it by:
```
git checkout -b issue/<Jira Ticket Key>-<New_Branch_Name>
```
or create a branch on the Jira ticket and
```
git pull
git checkout <branch_that_you_created_via_the_Jira_ticket>
```

## Start coding

Install an IDE to help you do auto formatting for a specific language.

However, you should know the basic rules about when you use capitcal/camel case etc.. for interview purpose.


## Add monitoring

Once you know where the bottleneck is in your code, it is always a good move to add monitoring around it.
No matter if it is the monitoring on the API success/error count, or DB time etc...

For example: 
* Implement a /healthcheck and configure Nginx/ALB to auto hit this endpoint every 5 seconds
* Log the request count, error count, status code and monitor the error rates
* Monitor the latency of the code

## Test

Before you submit for code review by peers, make sure that you have created some tests to test your code

Also, please make sure you have the CI pipeline to auto run the tests.

What are the common tests

![Alt text](../images/test_basics.jpg?raw=true)

### Unittest

Unit tests test individual components, it can be as small as a function.

![Alt text](../images/function.jpg?raw=true)

In python, you can run the test like this:

```
python -m unittest tests/test_something.py
```

### Integration Test

Integration Test is a level of software testing where individual units are combined and tested as a group.

For example, if you have a controller with REST APIs which is connected back to your database, sending REST requests to
the controller would be considered as integration test. You may use curl to call an endpoint like this:
```
curl --header "Content-Type: application/json" \
  --request POST \
  --data '{"username":"xyz","password":"xyz"}' \
  http://localhost:3000/api/login
```

### System Testing

Load Testing - is necessary to know that a software solution will perform under real-life loads. Gatling/Locust

### Acceptance Testing

User Acceptance Testing (UAT) is a type of testing performed by the end user or the client to verify/accept the
software system before moving the software application to the production environment.

Automation Test - blackbox monitoring from the customer perspective. Webdriver/Cypress

## Validate

Double check what has been committed
```
git status
git diff
```

## Commit the code

After commit and push the code, a PR link will be autogenerated and popped.

```
git add <files> 
git add -u
git commit  
git push
```
## Find peers to review the PR

### What can the CI pipeline help with?

* Code Linter/ Auto Formatter

* Syntax Checker

* Run Unit-test/End-to-end Test automatically and show the results

Many add-ons/tools can be used and we will cover it in later chapters

### What you can do as a developer:

* clearly write down the description and link to the Jira issue

* make sure you have good test coverage for your code

* make sure all builds are green

* ask peers to review and comment; fix issues and push changes recommended by peers.

## Merge the PR

once the PR is approved, you are good to merge.

### What CD pipeline can help with?

* Canary Deployment/Internal Test
* Run Integration Test/Regression Test/Performance Test etc...
* If issues identified, rollback before having customer impact

## Wait for staging deployment kicks off

Typically, in CI/CD pipeline, the staging branch will fast forward to master which should trigger the staging deployment

If everything is going well with staging deployment, there will be another few hours for soaking.

Engineers can take this opportunity to do more tests on staging environment and monitor the staging environment

## Wait for prod deployment kicks off

Once the soak is done and all tests passed, the prod deployment will kick off.

Keep an eye on the monitors to make sure nothing is saturated.



## Other Operation Questions

How do we make sure the App have zero downtime during deployment?
How do we rollback if there is a problem?
How do we recover fast/reduce Mean Time To Recover (MTTR) when there is a disaster(e.g. one server is down)?
How can we know where the bottleneck is?
I don't wanna watch the monitors, which metrics should we alert on?





